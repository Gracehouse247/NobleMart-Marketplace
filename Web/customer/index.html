<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Account | NobleMart</title>
    <link rel="icon" type="image/png" href="../assets/img/favicon.png">
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <link
        href="https://fonts.googleapis.com/css2?family=Manrope:wght@200..800&family=Poppins:wght@300;400;600;700&display=swap"
        rel="stylesheet" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" />
    <link rel="stylesheet" href="../assets/css/main.css">
    <script id="tailwind-config">
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        "primary": "#01c2ca",
                        "secondary": "#5C1BE8",
                        "background-light": "#f5f8f8",
                        "background-dark": "#0f2223",
                        "noble-gold": "#D4AF37",
                    },
                    fontFamily: {
                        "display": ["Manrope", "sans-serif"],
                        "poppins": ["Poppins", "sans-serif"]
                    },
                },
            },
        }
    </script>
    <style>
        .brand-gradient {
            background: linear-gradient(135deg, #01c2ca 0%, #5C1BE8 100%);
        }
    </style>
</head>

<body class="bg-[#f5f8f8] font-display text-[#101818]">
    <div class="flex min-h-screen">
        <!-- Sidebar -->
        <aside class="w-72 bg-white border-r border-[#dae6e7] flex flex-col fixed h-full z-20">
            <div class="p-6 flex items-center gap-3 cursor-pointer" onclick="window.location.href='/'">
                <div class="h-10 w-10 brand-gradient rounded-lg flex items-center justify-center text-white shadow-lg">
                    <span class="material-symbols-outlined">shopping_bag</span>
                </div>
                <div>
                    <h1 class="text-lg font-black leading-none tracking-tight">NobleMart</h1>
                    <p class="text-[10px] text-primary font-bold uppercase tracking-widest mt-1">Premium Client</p>
                </div>
            </div>
            <nav class="flex-1 px-4 py-4 flex flex-col gap-1">
                <a class="flex items-center gap-3 px-3 py-3 rounded-xl bg-primary/10 text-primary font-bold"
                    href="/customer">
                    <span class="material-symbols-outlined text-[20px]">person</span>
                    <span class="text-sm">Account Overview</span>
                </a>
                <a class="flex items-center gap-3 px-3 py-3 rounded-xl text-gray-500 hover:bg-gray-50 transition-all"
                    href="/customer/orders.html">
                    <span class="material-symbols-outlined text-[20px]">package_2</span>
                    <span class="text-sm">My Orders</span>
                </a>
                <a class="flex items-center gap-3 px-3 py-3 rounded-xl text-gray-500 hover:bg-gray-50 transition-all"
                    href="#">
                    <span class="material-symbols-outlined text-[20px]">favorite</span>
                    <span class="text-sm">Saved Items</span>
                </a>
                <a class="flex items-center gap-3 px-3 py-3 rounded-xl text-gray-500 hover:bg-gray-50 transition-all"
                    href="#">
                    <span class="material-symbols-outlined text-[20px]">inbox</span>
                    <span class="text-sm">Inbox</span>
                </a>
                <a class="flex items-center gap-3 px-3 py-3 rounded-xl text-gray-500 hover:bg-gray-50 transition-all"
                    href="#">
                    <span class="material-symbols-outlined text-[20px]">settings</span>
                    <span class="text-sm">Account Settings</span>
                </a>
            </nav>
            <div class="p-6 border-t border-gray-100">
                <button onclick="logout()"
                    class="w-full flex items-center gap-3 px-3 py-3 rounded-xl text-red-500 hover:bg-red-50 transition-colors font-bold text-sm">
                    <span class="material-symbols-outlined text-[20px]">logout</span>
                    Logout
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="ml-72 flex-1 pb-12">
            <header
                class="sticky top-0 z-10 bg-white/80 backdrop-blur-md px-8 py-6 border-b border-gray-100 flex items-center justify-between">
                <div>
                    <h2 class="text-2xl font-black tracking-tight" id="welcome-message">Hello, User</h2>
                    <p class="text-xs text-gray-400 font-bold uppercase tracking-widest mt-1">NobleMart Member Since
                        2024</p>
                </div>
                <div class="flex items-center gap-4">
                    <div
                        class="brand-gradient px-4 py-2 rounded-full text-[10px] font-black text-white shadow-lg uppercase tracking-wider">
                        NobleMart Prime
                    </div>
                </div>
            </header>

            <div class="px-8 mt-8 max-w-[1200px]">
                <!-- Stats Cards -->
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-12">
                    <div
                        class="flex flex-col justify-between gap-4 rounded-2xl brand-gradient p-6 text-white shadow-xl shadow-primary/20">
                        <div class="flex justify-between items-start">
                            <span
                                class="material-symbols-outlined p-2 bg-white/20 rounded-lg">account_balance_wallet</span>
                        </div>
                        <div>
                            <p class="text-[10px] font-bold uppercase tracking-widest opacity-70 mb-1">Total Savings</p>
                            <h3 class="text-2xl font-black">â‚¦14,250</h3>
                        </div>
                    </div>
                    <div class="flex flex-col gap-4 rounded-2xl bg-white p-6 border border-gray-100 shadow-sm">
                        <div class="h-10 w-10 bg-primary/10 rounded-lg flex items-center justify-center text-primary">
                            <span class="material-symbols-outlined">package_2</span>
                        </div>
                        <div>
                            <h2 class="text-sm font-black">Orders</h2>
                            <p class="text-xs text-gray-400 font-medium" id="order-count">0 Packages</p>
                        </div>
                    </div>
                    <div class="flex flex-col gap-4 rounded-2xl bg-white p-6 border border-gray-100 shadow-sm">
                        <div class="h-10 w-10 bg-primary/10 rounded-lg flex items-center justify-center text-primary">
                            <span class="material-symbols-outlined">favorite</span>
                        </div>
                        <div>
                            <h2 class="text-sm font-black">Wishlist</h2>
                            <p class="text-xs text-gray-400 font-medium">12 Saved Items</p>
                        </div>
                    </div>
                    <div class="flex flex-col gap-4 rounded-2xl bg-white p-6 border border-gray-100 shadow-sm">
                        <div class="h-10 w-10 bg-primary/10 rounded-lg flex items-center justify-center text-primary">
                            <span class="material-symbols-outlined">confirmation_number</span>
                        </div>
                        <div>
                            <h2 class="text-sm font-black">Vouchers</h2>
                            <p class="text-xs text-gray-500 font-medium">3 Active</p>
                        </div>
                    </div>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-3 gap-12">
                    <!-- Recent Orders Section -->
                    <div class="lg:col-span-2">
                        <div class="flex items-center justify-between mb-6">
                            <h3 class="text-xl font-black">Recent <span class="text-primary italic">Activity</span></h3>
                            <a class="text-secondary text-xs font-black uppercase tracking-widest hover:underline"
                                href="/customer/orders.html">Manage Orders</a>
                        </div>
                        <div id="recent-orders" class="space-y-4">
                            <!-- Orders will be loaded here -->
                            <div class="p-8 bg-white rounded-2xl border border-gray-100 text-center">
                                <p class="text-gray-400 font-bold italic">Loading activity...</p>
                            </div>
                        </div>
                    </div>

                    <!-- Profile Sidebar -->
                    <div class="lg:col-span-1">
                        <h3 class="text-xl font-black mb-6">Profile <span class="text-primary italic">Details</span>
                        </h3>
                        <div class="bg-white rounded-2xl border border-gray-100 p-8 shadow-sm">
                            <div class="flex items-center gap-4 mb-8">
                                <div class="h-16 w-16 brand-gradient rounded-full flex items-center justify-center text-white text-2xl font-black shadow-lg"
                                    id="user-avatar">
                                    ?
                                </div>
                                <div>
                                    <h4 class="font-black text-lg" id="user-name">Loading...</h4>
                                    <p class="text-xs text-primary font-bold uppercase tracking-widest">Verified Account
                                    </p>
                                </div>
                            </div>
                            <div class="space-y-6">
                                <div>
                                    <label
                                        class="block text-[10px] font-black text-gray-300 uppercase tracking-widest mb-1">Email</label>
                                    <p class="text-sm font-bold text-gray-700" id="user-email">...</p>
                                </div>
                                <div>
                                    <label
                                        class="block text-[10px] font-black text-gray-300 uppercase tracking-widest mb-1">Phone</label>
                                    <p class="text-sm font-bold text-gray-700" id="user-phone">...</p>
                                </div>
                                <button
                                    class="w-full mt-4 py-3 rounded-xl border border-primary text-primary font-bold hover:bg-primary hover:text-white transition-all text-xs tracking-widest uppercase">
                                    Edit Profile
                                </button>
                            </div>
                        </div>

                        <!-- Promo Banner -->
                        <div
                            class="mt-8 rounded-2xl overflow-hidden relative aspect-[4/3] group cursor-pointer shadow-xl">
                            <img src="https://images.unsplash.com/photo-1483985988355-763728e1935b?q=80&w=2070&auto=format&fit=crop"
                                class="absolute inset-0 w-full h-full object-cover group-hover:scale-110 transition-transform duration-500">
                            <div class="absolute inset-0 bg-gradient-to-t from-black/80 to-transparent"></div>
                            <div class="absolute bottom-6 left-6 text-white">
                                <span
                                    class="bg-primary px-2 py-0.5 rounded text-[8px] font-black uppercase tracking-widest mb-2 inline-block">Exclusive
                                    Deal</span>
                                <h4 class="font-black text-xl mb-1">Black Friday Prep</h4>
                                <p class="text-xs opacity-80">Up to 70% off global brands.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script>
        const token = localStorage.getItem('token');
        const userData = JSON.parse(localStorage.getItem('user') || '{}');

        if (!token) {
            window.location.href = '/login.html';
        }

        document.getElementById('user-name').textContent = userData.full_name || 'Noble Client';
        document.getElementById('welcome-message').textContent = `Hello, ${userData.full_name ? userData.full_name.split(' ')[0] : 'User'}`;
        document.getElementById('user-email').textContent = userData.email || '...';
        document.getElementById('user-phone').textContent = userData.phone || 'N/A';
        document.getElementById('user-avatar').textContent = userData.full_name ? userData.full_name[0] : '?';

        async function loadOverview() {
            try {
                const res = await fetch('https://api.noblemart.com.ng/orders/my-orders', {
                    headers: { 'Authorization': `Bearer ${token}` }
                });
                const orders = await res.json();

                document.getElementById('order-count').textContent = `${orders.length} Package${orders.length === 1 ? '' : 's'}`;

                const recentContainer = document.getElementById('recent-orders');
                if (orders.length > 0) {
                    recentContainer.innerHTML = orders.slice(0, 3).map(order => `
                        <div class="p-6 bg-white rounded-2xl border border-gray-100 shadow-sm flex items-center gap-6 group hover:border-primary transition-all">
                            <div class="h-16 w-16 rounded-xl bg-gray-50 flex items-center justify-center overflow-hidden">
                                <img src="${order.items[0] && order.items[0].images ? JSON.parse(order.items[0].images)[0] : 'https://placehold.co/100'}" class="w-full h-full object-cover">
                            </div>
                            <div class="flex-1">
                                <div class="flex justify-between items-start">
                                    <div>
                                        <h3 class="font-black text-sm group-hover:text-primary transition-colors">Order #NM-${order.id}</h3>
                                        <p class="text-[10px] text-gray-400 font-bold uppercase tracking-widest mt-1">${new Date(order.created_at).toLocaleDateString()}</p>
                                    </div>
                                    <span class="px-3 py-1 ${order.payment_status === 'paid' ? 'bg-green-100 text-green-700' : 'bg-yellow-100 text-yellow-700'} text-[8px] font-black uppercase rounded-full tracking-widest">
                                        ${order.status}
                                    </span>
                                </div>
                            </div>
                            <a href="/customer/orders.html" class="text-primary text-[10px] font-black uppercase tracking-widest hover:underline">Track</a>
                        </div>
                    `).join('');
                } else {
                    recentContainer.innerHTML = `
                        <div class="p-12 bg-white rounded-2xl border border-gray-100 text-center">
                            <span class="material-symbols-outlined text-4xl text-gray-200 mb-4">shopping_basket</span>
                            <p class="text-gray-400 font-bold italic">No recent activity found.</p>
                            <a href="/shop/category.html" class="inline-block mt-4 text-primary font-black text-xs uppercase tracking-widest hover:underline">Start Shopping</a>
                        </div>
                    `;
                }
            } catch (err) {
                console.error(err);
            }
        }

        function logout() {
            localStorage.clear();
            window.location.href = '/login.html';
        }

        loadOverview();
    </script>
</body>

</html>